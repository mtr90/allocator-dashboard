graph TB
    %% User Interface Layer
    subgraph "Frontend - React Application"
        UI[üñ•Ô∏è Allocator Dashboard UI]
        DRAG[üìÅ Drag & Drop Upload]
        JOBS[üìã Job Management]
        REPORTS[üìä Report Viewer]
        CONTEXT[üñ±Ô∏è Right-Click Context Menu]
    end

    %% User Actions
    USER[üë§ User] --> UI
    USER --> DRAG
    
    %% File Processing Flow
    DRAG --> |CSV File Upload| UPLOAD[‚¨ÜÔ∏è File Upload Handler]
    UPLOAD --> |FormData| API[üîß Backend API]
    
    %% Backend Processing
    subgraph "Backend - Node.js/Express on Vercel"
        API --> PARSE[üìÑ CSV Parser]
        PARSE --> |Extract Addresses| GEOCODE[üåç Geocoding Engine]
        GEOCODE --> |Real-time Processing| CENSUS[üèõÔ∏è US Census Bureau API]
        CENSUS --> |Coordinates & Match Codes| RESULTS[üìà Results Processor]
        RESULTS --> REPORTS_GEN[üìã Report Generator]
    end
    
    %% External Services
    subgraph "External APIs"
        CENSUS
        CENSUS_DESC[üìç Official US Government<br/>Geocoding Service<br/>‚úÖ Free & Reliable<br/>‚úÖ High Accuracy]
    end
    
    %% Data Processing
    subgraph "Data Processing Pipeline"
        PARSE --> |Up to 100 Records| BATCH[‚ö° Batch Processing]
        BATCH --> |50ms Delays| RATE[‚è±Ô∏è Rate Limiting]
        RATE --> GEOCODE
    end
    
    %% Report Generation
    subgraph "Report Generation"
        REPORTS_GEN --> JOB_SUMMARY[üìä Job Summary Report]
        REPORTS_GEN --> ALLOCATION_DETAIL[üìã Allocation Detail Report]
        REPORTS_GEN --> ALLOCATION_SUMMARY[üìà Allocation Summary Report]
        REPORTS_GEN --> SOURCE_DATA[üìÑ Source Data Report]
        REPORTS_GEN --> MATCH_EXCEPTIONS[‚ö†Ô∏è Match Exceptions Report]
    end
    
    %% Response Flow
    REPORTS_GEN --> |JSON Response| API
    API --> |Geocoded Results| UI
    UI --> JOBS
    JOBS --> |Display Results| REPORTS
    
    %% User Interactions
    JOBS --> |Right-Click| CONTEXT
    CONTEXT --> |Delete Job| DELETE[üóëÔ∏è Delete Handler]
    CONTEXT --> |Download Reports| DOWNLOAD[üíæ CSV Export]
    
    %% Infrastructure
    subgraph "Deployment Infrastructure"
        VERCEL[‚òÅÔ∏è Vercel Platform]
        GITHUB[üìö GitHub Repository]
        SERVERLESS[‚ö° Serverless Functions]
    end
    
    API -.-> SERVERLESS
    SERVERLESS -.-> VERCEL
    GITHUB -.-> VERCEL
    
    %% Match Code Processing
    subgraph "Match Code Classification"
        MATCH_0[‚úÖ Good Match - Code 0]
        MATCH_3[‚ùå No Candidates - Code 3]
        MATCH_4[üìÆ PO Box - Code 4]
        MATCH_OTHER[üìù Other Codes 1-9]
    end
    
    CENSUS --> MATCH_0
    CENSUS --> MATCH_3
    CENSUS --> MATCH_4
    CENSUS --> MATCH_OTHER
    
    %% Jurisdiction Assignment
    subgraph "Kentucky Jurisdiction Mapping"
        JURISDICTIONS[üó∫Ô∏è City/County Mapping]
        CODES[üè∑Ô∏è Jurisdiction Codes]
        COUNTIES[üèõÔ∏è County Assignment]
    end
    
    RESULTS --> JURISDICTIONS
    JURISDICTIONS --> CODES
    CODES --> COUNTIES
    
    %% Styling
    classDef userClass fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef frontendClass fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef backendClass fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef externalClass fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef infraClass fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef reportClass fill:#f1f8e9,stroke:#33691e,stroke-width:2px
    
    class USER userClass
    class UI,DRAG,JOBS,REPORTS,CONTEXT frontendClass
    class API,PARSE,GEOCODE,RESULTS,REPORTS_GEN,BATCH,RATE backendClass
    class CENSUS,CENSUS_DESC externalClass
    class VERCEL,GITHUB,SERVERLESS infraClass
    class JOB_SUMMARY,ALLOCATION_DETAIL,ALLOCATION_SUMMARY,SOURCE_DATA,MATCH_EXCEPTIONS reportClass
